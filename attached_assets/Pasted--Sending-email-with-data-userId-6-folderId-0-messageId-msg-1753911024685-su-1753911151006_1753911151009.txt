ğŸ“¤ Sending email with data: {
  userId: 6,
  folderId: 0,
  messageId: 'msg-1753911024685',
  subject: 'anexo',
  body: '<p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>aa</p><p>a</p>',
  fromAddress: 'aba@eliano.dev',
  fromName: '',
  toAddress: 'giusdadeppaeeliano@gmail.com',
  toName: null,
  ccAddress: null,
  bccAddress: null,
  hasAttachments: true,
  attachments: '[{"filename":"Email Professora ClÃ¡udia.pdf","path":"1753910997078_Email Professora ClÃ¡udia.pdf","size":177346,"mimetype":"application/pdf"}]',
  replyToAddress: null,
  isRead: true,
  isStarred: false,
  isDraft: false,
  priority: 'normal',
  tags: null
}
ğŸ”’ HTML content sanitized: {
  originalLength: 89,
  sanitizedLength: 89,
  dangerousContentRemoved: false
}
ğŸ”’ Email data sanitized for security
ğŸ“§ Final sanitized email data ready for sending
ğŸ“§ createEmail called with isDraft: 0 messageId: msg-1753911024685
ğŸ“§ Creating new email in database
ğŸ“ ATTACHMENTS DEBUG - Input email data: {
  attachments: '[{"filename":"Email Professora ClÃ¡udia.pdf","path":"1753910997078_Email Professora ClÃ¡udia.pdf","size":177346,"mimetype":"application/pdf"}]',
  hasAttachments: undefined,
  attachmentsType: 'string',
  attachmentsContent: '[{"filename":"Email Professora ClÃ¡udia.pdf","path":"1753910997078_Email Professora ClÃ¡udia.pdf","siz...'
}
ğŸ“ ATTACHMENTS DEBUG - Processing attachments in encryption: {
  originalAttachments: '[{"filename":"Email Professora ClÃ¡udia.pdf","path":"1753910997078_Email Professora ClÃ¡udia.pdf","size":177346,"mimetype":"application/pdf"}]',
  originalType: 'string',
  encryptedAttachments: [
    {
      filename: 'Email Professora ClÃ¡udia.pdf',
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      mimetype: 'application/pdf'
    }
  ],
  encryptedType: 'object',
  hasAttachments: 1,
  attachmentsCount: 1
}
ğŸ“ ATTACHMENTS DEBUG - Preserving hasAttachments flag: {
  originalHasAttachments: undefined,
  encryptedHasAttachments: 1,
  attachmentsLength: 1
}
ğŸ“ ATTACHMENTS DEBUG - Encrypted email data before DB insert: {
  attachments: [
    {
      filename: 'Email Professora ClÃ¡udia.pdf',
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      mimetype: 'application/pdf'
    }
  ],
  hasAttachments: 1,
  attachmentsType: 'object'
}
ğŸ“§ New email created with ID: 424
ğŸ“§ Email stored in database: 424
ğŸ“ Raw emailData.attachments: {
  hasAttachments: true,
  isArray: false,
  count: 140,
  attachments: '[{"filename":"Email Professora ClÃ¡udia.pdf","path":"1753910997078_Email Professora ClÃ¡udia.pdf","size":177346,"mimetype":"application/pdf"}]'
}
ğŸ“ Final SMTP attachments prepared: { count: 0, attachments: [] }
ğŸ“§ Sending email via SMTP using user credentials: {
  smtpAuthUser: 'aba@eliano.dev',
  realSender: 'aba@eliano.dev',
  recipient: 'giusdadeppaeeliano@gmail.com',
  subject: 'anexo'
}
RAW SMTP_HOST: "secmail.eliano.dev"
ğŸ“§ Preparing to send email: {
  from: 'aba@eliano.dev',
  to: 'giusdadeppaeeliano@gmail.com',
  subject: 'anexo',
  hasAttachments: false,
  hasInlineImages: false,
  attachmentsCount: 0,
  attachmentsData: []
}
ğŸ–¼ï¸ Extracted inline images from HTML: { found: 0, images: [] }
ğŸ–¼ï¸ Processing inline images: {
  inlineImagesCount: 0,
  htmlLength: 89,
  htmlSample: '<p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p><p>aa</p><p>a</p>...'
}
ğŸ“§ Sending email with user credentials: {
  smtpUser: 'aba@eliano.dev',
  from: 'aba@eliano.dev',
  to: 'giusdadeppaeeliano@gmail.com',
  subject: 'anexo',
  regularAttachments: [],
  cidAttachments: [],
  totalAttachments: 0
}
âœ… Email sent successfully: <bd6211a8-a21f-210c-38b1-7c361cf12d37@eliano.dev>
âœ… Email sent via SMTP successfully: <bd6211a8-a21f-210c-38b1-7c361cf12d37@eliano.dev>
ğŸ“ Updating email 424 - Original data: { subject: 'undefined...', body: 'undefined...' }
ğŸ“ ATTACHMENTS DEBUG - Update email input data: {
  attachments: undefined,
  hasAttachments: undefined,
  attachmentsType: 'undefined'
}
ğŸ“ ATTACHMENTS DEBUG - Raw database email data: {
  rawAttachments: [
    {
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      filename: 'Email Professora ClÃ¡udia.pdf',
      mimetype: 'application/pdf'
    }
  ],
  rawHasAttachments: undefined,
  rawAttachmentsType: 'object'
}
ğŸ“ PRESERVING existing attachments from database: {
  preservedAttachments: [
    {
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      filename: 'Email Professora ClÃ¡udia.pdf',
      mimetype: 'application/pdf'
    }
  ],
  preservedHasAttachments: undefined
}
ğŸ“ ATTACHMENTS DEBUG - Processing attachments in encryption: {
  originalAttachments: [
    {
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      filename: 'Email Professora ClÃ¡udia.pdf',
      mimetype: 'application/pdf'
    }
  ],
  originalType: 'object',
  encryptedAttachments: [
    {
      path: '1753910997078_Email Professora ClÃ¡udia.pdf',
      size: 177346,
      filename: 'Email Professora ClÃ¡udia.pdf',
      mimetype: 'application/pdf'
    }
  ],
  encryptedType: 'object',
  hasAttachments: 1,
  attachmentsCount: 1
}
ğŸ“ ATTACHMENTS DEBUG - Preserving hasAttachments flag: {
  originalHasAttachments: undefined,
  encryptedHasAttachments: 1,
  attachmentsLength: 1
}
ğŸ” Encrypted update data: { subject: 'undefined...', body: 'undefined...' }
ğŸ”“ Decrypted response data: { subject: 'anexo...', body: '<p>a</p><p>a</p><p>a</p><p>a</...' }